{"ast":null,"code":"import React,{useState,useContext,useEffect}from'react';import{useNavigate}from'react-router-dom';import{Box,Button,FormControl,FormLabel,Input,Stack,Heading,Text,useColorModeValue,Center,Alert,AlertIcon,FormErrorMessage,Image,Container}from'@chakra-ui/react';import AuthContext from'../context/AuthContext';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const Login=()=>{const[formData,setFormData]=useState({username:'',password:''});const[formErrors,setFormErrors]=useState({});const[isSubmitting,setIsSubmitting]=useState(false);const{login,isAuthenticated,isAdmin,error,clearError}=useContext(AuthContext);const navigate=useNavigate();const{username,password}=formData;// Redirect if already authenticated\nuseEffect(()=>{if(isAuthenticated){navigate('/');}},[isAuthenticated,navigate]);// Clear errors when unmounting\nuseEffect(()=>{return()=>{clearError();};},[clearError]);const onChange=e=>{setFormData({...formData,[e.target.name]:e.target.value});// Clear field error when typing\nif(formErrors[e.target.name]){setFormErrors({...formErrors,[e.target.name]:''});}};const validateForm=()=>{const errors={};if(!username.trim()){errors.username='Имя пользователя обязательно';}if(!password){errors.password='Пароль обязателен';}setFormErrors(errors);return Object.keys(errors).length===0;};const onSubmit=async e=>{e.preventDefault();if(!validateForm()){return;}setIsSubmitting(true);const success=await login(username,password);setIsSubmitting(false);if(success){navigate('/');}};return/*#__PURE__*/_jsx(Box,{minH:\"100vh\",bg:useColorModeValue('gray.50','gray.800'),py:12,children:/*#__PURE__*/_jsxs(Container,{maxW:\"lg\",children:[/*#__PURE__*/_jsx(Center,{mb:8,children:/*#__PURE__*/_jsx(Heading,{fontSize:\"3xl\",textAlign:\"center\",children:\"Clinic Price Manager\"})}),/*#__PURE__*/_jsx(Box,{bg:useColorModeValue('white','gray.700'),rounded:\"lg\",shadow:\"lg\",p:8,children:/*#__PURE__*/_jsxs(Stack,{spacing:6,children:[/*#__PURE__*/_jsx(Center,{children:/*#__PURE__*/_jsx(Heading,{size:\"lg\",children:\"\\u0412\\u0445\\u043E\\u0434 \\u0432 \\u0441\\u0438\\u0441\\u0442\\u0435\\u043C\\u0443\"})}),error&&/*#__PURE__*/_jsxs(Alert,{status:\"error\",rounded:\"md\",children:[/*#__PURE__*/_jsx(AlertIcon,{}),error]}),/*#__PURE__*/_jsx(\"form\",{onSubmit:onSubmit,children:/*#__PURE__*/_jsxs(Stack,{spacing:4,children:[/*#__PURE__*/_jsxs(FormControl,{id:\"username\",isRequired:true,isInvalid:!!formErrors.username,children:[/*#__PURE__*/_jsx(FormLabel,{children:\"\\u0418\\u043C\\u044F \\u043F\\u043E\\u043B\\u044C\\u0437\\u043E\\u0432\\u0430\\u0442\\u0435\\u043B\\u044F\"}),/*#__PURE__*/_jsx(Input,{type:\"text\",name:\"username\",value:username,onChange:onChange,size:\"lg\",bg:useColorModeValue('white','gray.700'),borderColor:useColorModeValue('gray.300','gray.600'),_focus:{borderColor:'brand.500',boxShadow:'0 0 0 1px var(--chakra-colors-brand-500)'}}),/*#__PURE__*/_jsx(FormErrorMessage,{children:formErrors.username})]}),/*#__PURE__*/_jsxs(FormControl,{id:\"password\",isRequired:true,isInvalid:!!formErrors.password,children:[/*#__PURE__*/_jsx(FormLabel,{children:\"\\u041F\\u0430\\u0440\\u043E\\u043B\\u044C\"}),/*#__PURE__*/_jsx(Input,{type:\"password\",name:\"password\",value:password,onChange:onChange,size:\"lg\",bg:useColorModeValue('white','gray.700'),borderColor:useColorModeValue('gray.300','gray.600'),_focus:{borderColor:'brand.500',boxShadow:'0 0 0 1px var(--chakra-colors-brand-500)'}}),/*#__PURE__*/_jsx(FormErrorMessage,{children:formErrors.password})]}),/*#__PURE__*/_jsx(Button,{colorScheme:\"brand\",bg:\"brand.500\",color:\"white\",_hover:{bg:'brand.600'},size:\"lg\",type:\"submit\",isLoading:isSubmitting,w:\"100%\",mt:4,children:\"\\u0412\\u043E\\u0439\\u0442\\u0438\"})]})})]})})]})});};export default Login;","map":{"version":3,"names":["React","useState","useContext","useEffect","useNavigate","Box","Button","FormControl","FormLabel","Input","Stack","Heading","Text","useColorModeValue","Center","Alert","AlertIcon","FormErrorMessage","Image","Container","AuthContext","jsx","_jsx","jsxs","_jsxs","Login","formData","setFormData","username","password","formErrors","setFormErrors","isSubmitting","setIsSubmitting","login","isAuthenticated","isAdmin","error","clearError","navigate","onChange","e","target","name","value","validateForm","errors","trim","Object","keys","length","onSubmit","preventDefault","success","minH","bg","py","children","maxW","mb","fontSize","textAlign","rounded","shadow","p","spacing","size","status","id","isRequired","isInvalid","type","borderColor","_focus","boxShadow","colorScheme","color","_hover","isLoading","w","mt"],"sources":["/Users/macbook1/Programming/jsstoma/client/src/pages/Login.js"],"sourcesContent":["import React, { useState, useContext, useEffect } from 'react';\nimport { useNavigate } from 'react-router-dom';\nimport {\n  Box,\n  Button,\n  FormControl,\n  FormLabel,\n  Input,\n  Stack,\n  Heading,\n  Text,\n  useColorModeValue,\n  Center,\n  Alert,\n  AlertIcon,\n  FormErrorMessage,\n  Image,\n  Container,\n} from '@chakra-ui/react';\nimport AuthContext from '../context/AuthContext';\n\nconst Login = () => {\n  const [formData, setFormData] = useState({\n    username: '',\n    password: '',\n  });\n  const [formErrors, setFormErrors] = useState({});\n  const [isSubmitting, setIsSubmitting] = useState(false);\n  \n  const { login, isAuthenticated, isAdmin, error, clearError } = useContext(AuthContext);\n  const navigate = useNavigate();\n  \n  const { username, password } = formData;\n  \n  // Redirect if already authenticated\n  useEffect(() => {\n    if (isAuthenticated) {\n      navigate('/');\n    }\n  }, [isAuthenticated, navigate]);\n  \n  // Clear errors when unmounting\n  useEffect(() => {\n    return () => {\n      clearError();\n    };\n  }, [clearError]);\n  \n  const onChange = e => {\n    setFormData({ ...formData, [e.target.name]: e.target.value });\n    \n    // Clear field error when typing\n    if (formErrors[e.target.name]) {\n      setFormErrors({\n        ...formErrors,\n        [e.target.name]: ''\n      });\n    }\n  };\n  \n  const validateForm = () => {\n    const errors = {};\n    if (!username.trim()) {\n      errors.username = 'Имя пользователя обязательно';\n    }\n    if (!password) {\n      errors.password = 'Пароль обязателен';\n    }\n    \n    setFormErrors(errors);\n    return Object.keys(errors).length === 0;\n  };\n  \n  const onSubmit = async e => {\n    e.preventDefault();\n    \n    if (!validateForm()) {\n      return;\n    }\n    \n    setIsSubmitting(true);\n    const success = await login(username, password);\n    setIsSubmitting(false);\n    \n    if (success) {\n      navigate('/');\n    }\n  };\n  \n  return (\n    <Box \n      minH=\"100vh\" \n      bg={useColorModeValue('gray.50', 'gray.800')}\n      py={12}\n    >\n      <Container maxW=\"lg\">\n        <Center mb={8}>\n          <Heading fontSize=\"3xl\" textAlign=\"center\">Clinic Price Manager</Heading>\n        </Center>\n        \n        <Box\n          bg={useColorModeValue('white', 'gray.700')}\n          rounded=\"lg\"\n          shadow=\"lg\"\n          p={8}\n        >\n          <Stack spacing={6}>\n            <Center>\n              <Heading size=\"lg\">Вход в систему</Heading>\n            </Center>\n            \n            {error && (\n              <Alert status=\"error\" rounded=\"md\">\n                <AlertIcon />\n                {error}\n              </Alert>\n            )}\n            \n            <form onSubmit={onSubmit}>\n              <Stack spacing={4}>\n                <FormControl id=\"username\" isRequired isInvalid={!!formErrors.username}>\n                  <FormLabel>Имя пользователя</FormLabel>\n                  <Input\n                    type=\"text\"\n                    name=\"username\"\n                    value={username}\n                    onChange={onChange}\n                    size=\"lg\"\n                    bg={useColorModeValue('white', 'gray.700')}\n                    borderColor={useColorModeValue('gray.300', 'gray.600')}\n                    _focus={{\n                      borderColor: 'brand.500',\n                      boxShadow: '0 0 0 1px var(--chakra-colors-brand-500)',\n                    }}\n                  />\n                  <FormErrorMessage>{formErrors.username}</FormErrorMessage>\n                </FormControl>\n                \n                <FormControl id=\"password\" isRequired isInvalid={!!formErrors.password}>\n                  <FormLabel>Пароль</FormLabel>\n                  <Input\n                    type=\"password\"\n                    name=\"password\"\n                    value={password}\n                    onChange={onChange}\n                    size=\"lg\"\n                    bg={useColorModeValue('white', 'gray.700')}\n                    borderColor={useColorModeValue('gray.300', 'gray.600')}\n                    _focus={{\n                      borderColor: 'brand.500',\n                      boxShadow: '0 0 0 1px var(--chakra-colors-brand-500)',\n                    }}\n                  />\n                  <FormErrorMessage>{formErrors.password}</FormErrorMessage>\n                </FormControl>\n                \n                <Button\n                  colorScheme=\"brand\"\n                  bg=\"brand.500\"\n                  color=\"white\"\n                  _hover={{\n                    bg: 'brand.600',\n                  }}\n                  size=\"lg\"\n                  type=\"submit\"\n                  isLoading={isSubmitting}\n                  w=\"100%\"\n                  mt={4}\n                >\n                  Войти\n                </Button>\n              </Stack>\n            </form>\n          </Stack>\n        </Box>\n      </Container>\n    </Box>\n  );\n};\n\nexport default Login; "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}