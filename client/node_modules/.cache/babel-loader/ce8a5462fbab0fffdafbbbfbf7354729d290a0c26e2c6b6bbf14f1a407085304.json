{"ast":null,"code":"import React,{createContext,useState,useEffect}from'react';import API from'../utils/api';import{jsx as _jsx}from\"react/jsx-runtime\";const AuthContext=/*#__PURE__*/createContext();export const AuthProvider=_ref=>{let{children}=_ref;const[user,setUser]=useState(null);const[isAuthenticated,setIsAuthenticated]=useState(false);const[isAdmin,setIsAdmin]=useState(false);const[isLoading,setIsLoading]=useState(true);const[error,setError]=useState(null);// Load user on first render\nuseEffect(()=>{const loadUser=async()=>{if(localStorage.getItem('token')){try{const res=await API.get('/auth/me');setUser(res.data);setIsAuthenticated(true);setIsAdmin(res.data.role==='admin');}catch(err){var _err$response,_err$response$data;localStorage.removeItem('token');setUser(null);setIsAuthenticated(false);setIsAdmin(false);setError(((_err$response=err.response)===null||_err$response===void 0?void 0:(_err$response$data=_err$response.data)===null||_err$response$data===void 0?void 0:_err$response$data.message)||'Authentication error');}}setIsLoading(false);};loadUser();},[]);// Login user\nconst login=async(username,password)=>{try{const res=await API.post('/auth/login',{username,password});localStorage.setItem('token',res.data.token);// Get user data\nconst userRes=await API.get('/auth/me');setUser(userRes.data);setIsAuthenticated(true);setIsAdmin(userRes.data.role==='admin');setError(null);return true;}catch(err){var _err$response2,_err$response2$data;setError(((_err$response2=err.response)===null||_err$response2===void 0?void 0:(_err$response2$data=_err$response2.data)===null||_err$response2$data===void 0?void 0:_err$response2$data.message)||'Login failed');return false;}};// Logout user\nconst logout=()=>{localStorage.removeItem('token');setUser(null);setIsAuthenticated(false);setIsAdmin(false);};// Clear error\nconst clearError=()=>{setError(null);};return/*#__PURE__*/_jsx(AuthContext.Provider,{value:{user,isAuthenticated,isAdmin,isLoading,error,login,logout,clearError},children:children});};export default AuthContext;","map":{"version":3,"names":["React","createContext","useState","useEffect","API","jsx","_jsx","AuthContext","AuthProvider","_ref","children","user","setUser","isAuthenticated","setIsAuthenticated","isAdmin","setIsAdmin","isLoading","setIsLoading","error","setError","loadUser","localStorage","getItem","res","get","data","role","err","_err$response","_err$response$data","removeItem","response","message","login","username","password","post","setItem","token","userRes","_err$response2","_err$response2$data","logout","clearError","Provider","value"],"sources":["/Users/macbook1/Programming/jsstoma/client/src/context/AuthContext.js"],"sourcesContent":["import React, { createContext, useState, useEffect } from 'react';\nimport API from '../utils/api';\n\nconst AuthContext = createContext();\n\nexport const AuthProvider = ({ children }) => {\n  const [user, setUser] = useState(null);\n  const [isAuthenticated, setIsAuthenticated] = useState(false);\n  const [isAdmin, setIsAdmin] = useState(false);\n  const [isLoading, setIsLoading] = useState(true);\n  const [error, setError] = useState(null);\n\n  // Load user on first render\n  useEffect(() => {\n    const loadUser = async () => {\n      if (localStorage.getItem('token')) {\n        try {\n          const res = await API.get('/auth/me');\n          setUser(res.data);\n          setIsAuthenticated(true);\n          setIsAdmin(res.data.role === 'admin');\n        } catch (err) {\n          localStorage.removeItem('token');\n          setUser(null);\n          setIsAuthenticated(false);\n          setIsAdmin(false);\n          setError(err.response?.data?.message || 'Authentication error');\n        }\n      }\n      \n      setIsLoading(false);\n    };\n    \n    loadUser();\n  }, []);\n\n  // Login user\n  const login = async (username, password) => {\n    try {\n      const res = await API.post('/auth/login', { username, password });\n      \n      localStorage.setItem('token', res.data.token);\n      \n      // Get user data\n      const userRes = await API.get('/auth/me');\n      setUser(userRes.data);\n      setIsAuthenticated(true);\n      setIsAdmin(userRes.data.role === 'admin');\n      setError(null);\n      \n      return true;\n    } catch (err) {\n      setError(err.response?.data?.message || 'Login failed');\n      return false;\n    }\n  };\n\n  // Logout user\n  const logout = () => {\n    localStorage.removeItem('token');\n    setUser(null);\n    setIsAuthenticated(false);\n    setIsAdmin(false);\n  };\n\n  // Clear error\n  const clearError = () => {\n    setError(null);\n  };\n\n  return (\n    <AuthContext.Provider\n      value={{\n        user,\n        isAuthenticated,\n        isAdmin,\n        isLoading,\n        error,\n        login,\n        logout,\n        clearError\n      }}\n    >\n      {children}\n    </AuthContext.Provider>\n  );\n};\n\nexport default AuthContext; "],"mappings":"AAAA,MAAO,CAAAA,KAAK,EAAIC,aAAa,CAAEC,QAAQ,CAAEC,SAAS,KAAQ,OAAO,CACjE,MAAO,CAAAC,GAAG,KAAM,cAAc,CAAC,OAAAC,GAAA,IAAAC,IAAA,yBAE/B,KAAM,CAAAC,WAAW,cAAGN,aAAa,CAAC,CAAC,CAEnC,MAAO,MAAM,CAAAO,YAAY,CAAGC,IAAA,EAAkB,IAAjB,CAAEC,QAAS,CAAC,CAAAD,IAAA,CACvC,KAAM,CAACE,IAAI,CAAEC,OAAO,CAAC,CAAGV,QAAQ,CAAC,IAAI,CAAC,CACtC,KAAM,CAACW,eAAe,CAAEC,kBAAkB,CAAC,CAAGZ,QAAQ,CAAC,KAAK,CAAC,CAC7D,KAAM,CAACa,OAAO,CAAEC,UAAU,CAAC,CAAGd,QAAQ,CAAC,KAAK,CAAC,CAC7C,KAAM,CAACe,SAAS,CAAEC,YAAY,CAAC,CAAGhB,QAAQ,CAAC,IAAI,CAAC,CAChD,KAAM,CAACiB,KAAK,CAAEC,QAAQ,CAAC,CAAGlB,QAAQ,CAAC,IAAI,CAAC,CAExC;AACAC,SAAS,CAAC,IAAM,CACd,KAAM,CAAAkB,QAAQ,CAAG,KAAAA,CAAA,GAAY,CAC3B,GAAIC,YAAY,CAACC,OAAO,CAAC,OAAO,CAAC,CAAE,CACjC,GAAI,CACF,KAAM,CAAAC,GAAG,CAAG,KAAM,CAAApB,GAAG,CAACqB,GAAG,CAAC,UAAU,CAAC,CACrCb,OAAO,CAACY,GAAG,CAACE,IAAI,CAAC,CACjBZ,kBAAkB,CAAC,IAAI,CAAC,CACxBE,UAAU,CAACQ,GAAG,CAACE,IAAI,CAACC,IAAI,GAAK,OAAO,CAAC,CACvC,CAAE,MAAOC,GAAG,CAAE,KAAAC,aAAA,CAAAC,kBAAA,CACZR,YAAY,CAACS,UAAU,CAAC,OAAO,CAAC,CAChCnB,OAAO,CAAC,IAAI,CAAC,CACbE,kBAAkB,CAAC,KAAK,CAAC,CACzBE,UAAU,CAAC,KAAK,CAAC,CACjBI,QAAQ,CAAC,EAAAS,aAAA,CAAAD,GAAG,CAACI,QAAQ,UAAAH,aAAA,kBAAAC,kBAAA,CAAZD,aAAA,CAAcH,IAAI,UAAAI,kBAAA,iBAAlBA,kBAAA,CAAoBG,OAAO,GAAI,sBAAsB,CAAC,CACjE,CACF,CAEAf,YAAY,CAAC,KAAK,CAAC,CACrB,CAAC,CAEDG,QAAQ,CAAC,CAAC,CACZ,CAAC,CAAE,EAAE,CAAC,CAEN;AACA,KAAM,CAAAa,KAAK,CAAG,KAAAA,CAAOC,QAAQ,CAAEC,QAAQ,GAAK,CAC1C,GAAI,CACF,KAAM,CAAAZ,GAAG,CAAG,KAAM,CAAApB,GAAG,CAACiC,IAAI,CAAC,aAAa,CAAE,CAAEF,QAAQ,CAAEC,QAAS,CAAC,CAAC,CAEjEd,YAAY,CAACgB,OAAO,CAAC,OAAO,CAAEd,GAAG,CAACE,IAAI,CAACa,KAAK,CAAC,CAE7C;AACA,KAAM,CAAAC,OAAO,CAAG,KAAM,CAAApC,GAAG,CAACqB,GAAG,CAAC,UAAU,CAAC,CACzCb,OAAO,CAAC4B,OAAO,CAACd,IAAI,CAAC,CACrBZ,kBAAkB,CAAC,IAAI,CAAC,CACxBE,UAAU,CAACwB,OAAO,CAACd,IAAI,CAACC,IAAI,GAAK,OAAO,CAAC,CACzCP,QAAQ,CAAC,IAAI,CAAC,CAEd,MAAO,KAAI,CACb,CAAE,MAAOQ,GAAG,CAAE,KAAAa,cAAA,CAAAC,mBAAA,CACZtB,QAAQ,CAAC,EAAAqB,cAAA,CAAAb,GAAG,CAACI,QAAQ,UAAAS,cAAA,kBAAAC,mBAAA,CAAZD,cAAA,CAAcf,IAAI,UAAAgB,mBAAA,iBAAlBA,mBAAA,CAAoBT,OAAO,GAAI,cAAc,CAAC,CACvD,MAAO,MAAK,CACd,CACF,CAAC,CAED;AACA,KAAM,CAAAU,MAAM,CAAGA,CAAA,GAAM,CACnBrB,YAAY,CAACS,UAAU,CAAC,OAAO,CAAC,CAChCnB,OAAO,CAAC,IAAI,CAAC,CACbE,kBAAkB,CAAC,KAAK,CAAC,CACzBE,UAAU,CAAC,KAAK,CAAC,CACnB,CAAC,CAED;AACA,KAAM,CAAA4B,UAAU,CAAGA,CAAA,GAAM,CACvBxB,QAAQ,CAAC,IAAI,CAAC,CAChB,CAAC,CAED,mBACEd,IAAA,CAACC,WAAW,CAACsC,QAAQ,EACnBC,KAAK,CAAE,CACLnC,IAAI,CACJE,eAAe,CACfE,OAAO,CACPE,SAAS,CACTE,KAAK,CACLe,KAAK,CACLS,MAAM,CACNC,UACF,CAAE,CAAAlC,QAAA,CAEDA,QAAQ,CACW,CAAC,CAE3B,CAAC,CAED,cAAe,CAAAH,WAAW","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}